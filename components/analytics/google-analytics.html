<!-- Google Analytics 4 (GA4) -->
<!-- Replace G-XXXXXXXXXX with your actual Google Analytics Measurement ID -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
    // Load GA Measurement ID from config or use default
    const GA_MEASUREMENT_ID = window.ANALYTICS_CONFIG?.GA_MEASUREMENT_ID || 'G-XXXXXXXXXX';
    const GA_ENABLED = window.ANALYTICS_CONFIG?.ENABLED !== false;
    
    if (GA_ENABLED && GA_MEASUREMENT_ID && GA_MEASUREMENT_ID !== 'G-XXXXXXXXXX') {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', GA_MEASUREMENT_ID, {
            // Privacy-friendly settings
            'anonymize_ip': true,
            'allow_google_signals': false,
            'allow_ad_personalization_signals': false
        });
        
        // Track page views on navigation (for SPA-like behavior)
        if (typeof window !== 'undefined' && window.history) {
            let lastUrl = location.href;
            new MutationObserver(() => {
                const url = location.href;
                if (url !== lastUrl) {
                    lastUrl = url;
                    gtag('config', GA_MEASUREMENT_ID, {
                        'page_path': location.pathname + location.search
                    });
                }
            }).observe(document, { subtree: true, childList: true });
        }
    }
</script>

